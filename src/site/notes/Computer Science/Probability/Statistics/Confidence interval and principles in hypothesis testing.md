---
{"dateCreated":"2023-08-04 12:39","tags":["statistics","cs_biu"],"pageDirection":"rtl","dg-publish":true,"permalink":"/computer-science/probability/statistics/confidence-interval-and-principles-in-hypothesis-testing/","dgPassFrontmatter":true}
---


# רווח סמך ועקרונות בבדיקת השערות 

דיברנו על [[Computer Science/Probability/Statistics/Point statistical estimation\|אומדן סטטיסטי נקודתי]] $\hat\Theta$ לפרמטר $\theta$ ועל אומדנים המקיימים תכונות מסויימות כמו חוסר הטייה. 

נרצה כעת לענות על השאלה __מהי מידת הדיוק של האומד__.
כפי שניתן לצפות, מידת הדיוק של אומד תגדל ככל שהמדגם שעליו הוא מבוסס גדול יותר.
מכאן תעלה באופן טבעי שאלה נוספת: __מה צריך להיות גודלו של המדגם שיבטיח רמת דיוק רצויה באמידה מסוימת?__

## מידת הדיוק של אומד
[[Computer Science/Probability/Statistics/Statistical inference basics#משפט הגבול המרכזי\|משפט הגבול המרכזי]] שבמדגם מקרי $X_{1},\dots,X_{n}$ מתוך משתנה מקרי $X$ בעל תוחלת $\mu$ ושונות $\sigma^{2}$ מתקיים עבור $n>30$ 

$$\overline{X}\sim N\left(\mu, \frac{\sigma^{2}}{n}\right)$$
כלומר עבור מדגמים גדולים מ$30$ ממוצע המדגם מתפלג נורמלית (בקירוב). ואם המ״מ שממנו דוגמים מתפלג נורמלית אז בלי תלות ב$n$ ממוצע המדגם גם מתפלג נורמלית.

__נסתכל על הדוגמה הבאה:__
במדגם שגודלו $25$ מתוך מ״מ  $X$ המפולג נורמלית בעל סטיית של $10$ ותוחלת $\mu$ נרצה לדעת מהי ההסתברות שממוצע המדגם שיתקבל יהיה שונה מ$\mu$ בלא יותר מ$4$ יחידות.

כלומר נתון לנו $X\sim N(\mu,100)$ ו $n=25$ מכאן שממוצע המדגם מפולג נורמלי עם תוחלת $\mu$ ושונות $\frac{100}{25}=4$ (כלומר סטיית תקן $2$). $\overline{X}\sim N(\mu,4)$ .

אנחנו מנסים לחשב את ההסתברות $P(\mu-4,\overline{X},\mu+4)$ . ננרמל כל אחד מהטווחים: $z_{\mu+4}= \frac{\mu+4-\mu}{2}= 2$ , $z_{\mu-4}= \frac{\mu-4-\mu}{2}= -2$ כלומר לאחר הנרמול מתקיים $P(\mu-4<\overline{X}<\mu+4)=P(-2<Z<2)$  .

השאלה _״מהי ההסתברות שהממוצע יהיה במרחק 4 יחידות מממוצע ההתפלגות״_ שקולה לשאלה _״מהי ההסתברות שהממוצע יהיה במרחק 2 סטיות תקן מממוצע ההתפלגות״_. זאת משום שסטיית התקן של ההתפלגות היא $2$. נחשב ונקבל 

$$\Phi(2)-\Phi(-2)= 2(\Phi(2))-1=0.95$$

![Screenshot 2023-08-04 at 14.04.41.png](/img/user/Assets/Screenshot%202023-08-04%20at%2014.04.41.png)
התרשים מציג את התוצאה שקיבלנו כאשר ציר $Z$ הוא ציר שאומד את המרחק ביחידות של סטיות תקן.

אפשר להתסכל על זה גם בדרך אחרת:
![Screenshot 2023-08-04 at 14.11.50.png](/img/user/Assets/Screenshot%202023-08-04%20at%2014.11.50.png)
הציר האנכי הוא ציר $\overline{x}$ , כלומר ערכי המשתנה $\overline{X}$ . על הציר האופקי מסומנים מספרי הניסויים (החזרות על הדגימה). כל נקודה מתארת ערך של ממוצע המדגם $\overline{x}$ עבור הניסוי ה$i$ בציר האנכי. ככל שנעשה יותר דגימות נראה כי $95\%$ מהערכים נמצאים בסביבה של $\pm 4$ יחידות סביב התוחלת.

האי שיוויון: 

$$\mu-4<\overline{X}<\mu+4$$
שקול לאי שיוויון 
$$\overline{X}-4<\mu<\overline{X}+4$$

ולכן גם ההסתברות $P(\overline{X}-4<\mu<\overline{X}+4)=0.95$ . נבטא זאת באופן מילולי:
$\overline{X}-4<\mu<\overline{X}+4$ הוא __רווח-סמך__ ברמה של $95\%$ עבור $\mu$. כלומר, במדגם שגודלו $n=25$ מתוך מ״מ $X$ המפולג נורמלית עם סטיית תקן $10$ ותוחלת $\mu$ בלתי ידועה, ההסתברות ש $\mu$ תהיה שונה ממוצע המדגם בלא יור מאשר $4$ יחידות היא $0.95$ .

__נדגיש__ כי $\mu$ הוא קבוע ובלתי ידוע ואילו קצוות הטווח משתנים מניסוי לניסוי.
![Screenshot 2023-08-04 at 14.16.59.png](/img/user/Assets/Screenshot%202023-08-04%20at%2014.16.59.png)
ניתן לראות בתרשים את רווח הסמך הנ״ל כל נקודה מותחת קו של 4 יחידות מלמעלה ומלמטה וניתן לראות שכ$95\%$ מהנקודות אכן חוצות את הקו האופקי שמתאר את $\mu$.

השיוויון $P(\overline{X}-4<\mu<\overline{X}+4)=0.95$ הוא מקרה פרטי של שיוויון מהצורה $P(A<\theta<B)=1-\alpha$ כאשר $\theta$ הוא הפרמטר הנאמד. 

הרווח $(A,B)$ נקבע על ידי הסטטיסטי האומד $\hat\Theta$ ומשתנה ממדגם למדגם (נקרא _״רווח מקרי״_). $1-\alpha$ הוא קריטריון דיוק שבדרך כלל יהיה קרוב ל$1$. כלומר 
__הרווח $A<\theta<B$ הוא רווח-סמך ברמה של $100(1-\alpha)$ אחוז עבור $\theta$__ .

באופן כללי אפשר לבטא את רווח הסמך מהדוגמה שלנו כך 

$$P\left(\mu- z \frac{\sigma}{\sqrt{n}}<\overline{X}<\mu+ z \frac{\sigma}{\sqrt{n}}\right)= 2\Phi(z)-1$$

כדי שאגף ימין ישווה ל $1-\alpha$ צריך שיתקיים $\Phi(z)=1- \frac{\alpha}{2}$ . נסמן את ערך $z$ המקיים זאת כ $z_{1-\frac{\alpha}{2}}$ ונציב:

$$P\left(\mu- z_{1-\frac{\alpha}{2}} \frac{\sigma}{\sqrt{n}}<\overline{X}<\mu+ z_{1-\frac{\alpha}{2}} \frac{\sigma}{\sqrt{n}}\right)= 1-\alpha$$

![Screenshot 2023-08-04 at 14.25.23.png|450](/img/user/Assets/Screenshot%202023-08-04%20at%2014.25.23.png)

כל שנשאר לעשות כעת הוא להחליף בסדר של הא״ש ונקבל

$$P\left(\overline{X}- z_{1-\frac{\alpha}{2}} \frac{\sigma}{\sqrt{n}}<\mu<\overline{X}+ z_{1-\frac{\alpha}{2}} \frac{\sigma}{\sqrt{n}}\right)= 1-\alpha$$

כלומר __רווח-סמך__ ברמה של $(1-\alpha)\cdot 100$ אחוז עבור $\mu$ הוא 
$$\overline{X}- z_{1-\frac{\alpha}{2}} \frac{\sigma}{\sqrt{n}}<\mu<\overline{X}+ z_{1-\frac{\alpha}{2}} \frac{\sigma}{\sqrt{n}}$$

>[!note] מסקנה
>ככל שרמת הסמך גבוהה יותר, כך מתרחב רווח הסמך

### הקשר בין גודל המדגם לדיוק הנדרש
במקרים רבים אנו קובעים מראש את רמת הסמך באחוזים ושואלים מהו גודל המדגם, שיבטיח ברמת סמך זו, ששגיאת האמידה, כלומר ריחוקו של האומד $\overline{X}$ מן הערך האמיתי $\mu$ , לא תעלה על $\varepsilon$ . במילים אחרות, נרצה להבטיח שנקבל רווח סמך של $(\overline{X}-\varepsilon<\mu,\overline{X}+\varepsilon)$ ברמת סמך $(1-\alpha)$. כלומר נרצה לפתור את הביטוי 

$$z_{1-\frac{\alpha}{2}} \frac{\sigma}{\sqrt{n}} = \varepsilon$$

סך הכל נקבל 

$$n= \left( \frac{z_{1-\frac{\alpha}{2}}\sigma}{\varepsilon}\right)^{2}$$

וכדי להבטיח ש $n\in\mathbb{N}$ נחליף את הכמת $=$ בכמת $\geq$ . וסך הכל קיבלנו ביטוח לגודל המדגם.

## עקרונות של בדיקת השערות
האומדן של פרמטר בלתי ידוע הוא רק יישום אחד של ההסקה הסטטיסטית.
לעתים קרובות יותר משאנו מעוניינים באומדן של פרמטר, אנו מעוניינים בבדיקת השערה מסוימת שיש לנו לגביו.

נסתכל על דוגמה של מבחן סטטיסטי כדי להבין יותר טוב:
אל משרד המסחר והתעשייה הגיעו תלונות צרכנים על כך, שמשקל הלחם הנאפה במאפייה מסוימת נופל מן המשקל הנקוב על האריזה שהוא 500 גרם.

כדי לבדוק את התלונה הזו, החליט המשרד לבצע __מבחן סטטיסטי__ כלומר בדיקת השערה בשיטות סטטיסטיות. לשם כך נדגמו ונשקלו 30 כיכרות לחם של אותה מאפייה והרי המשקלים:
![Screenshot 2023-08-04 at 15.13.33.png](/img/user/Assets/Screenshot%202023-08-04%20at%2015.13.33.png)
אנשי המחקר במשרד מודעים לכך שלא ייתכן שמשקלה של כל כיכר יהיה בידיוק 500 גרם. הניסיון הראה כי סטיית התקן של משקלן של כיכרות לחם הנאפים במאפייה מודרנית, תוך הקפדה סבירה על אחידותן, היא 3 גרמים, אך __תוחלת המשקל__ חייבת להיות 500 גרם.

אנשי המחקר צריכים להסיק מתוך הנתונים שנאספו במדגם של 30 ככרות הלחם אם הצרכנים צדקו בתלונתם.

נמצא שממוצע המשקלים של כיכרות הלחם במדגם הוא $498.5$ גרם. משקלה של כיכר לחם $X$ הוא משתנה מקרי, שיכול לקבל ערכים שונים, וכך גם ממוצע המדגם $\overline{X}$. לכן, גם כאשר תוחלת המשקל של כיכרות הלחם היא $500$ ממוצע המשקלים של מדגם מקרי בן $30$ יכול להיות שונה. אולם, ממוצע כזה יכול גם לרמז שתוחלת המשקל אינה $500$ גרם אלא פחות מכך. התוחלת, אם כן, __״עומדת למשפט״__ ואנשי המחקר משערים שתי השערות מנוגדות עליה: 

1. תוחלת המשקל שווה ל 500 ורק במקרה התקבל במדגם ממוצע שונה.
2. התוחלת של המשקל קטנה מ500 וממוצע המדגם מרמז על כך.

החוקרים כעת צריכים להחליט באיזו משתי ההשערות לתמוך לאור המדגם הנתון, שהממוצע שלו הוא $\overline{x}=498.5$ .

הגישה שהחוקרים נוקטים היא: נניח שההשערה הראשונה נכונה, כלומר תוחלת המשקל של כיכר לחם היא אמנם 500 גרם. באיזו מידה סביר לקבל מדגם שהממוצע שלו זהה לממוצע שנתקבל או קטן ממנו?

כלומר, החוקרים רוצים לבדוק $P(\overline{X}\leq 498.5)$ , בהנחה שטענת המאפייה נכונה. אם יתברר שהסתברות זו קטנה מאוד, החוקרים ייאלצו להסיק שתוחלת המשקל של כיכר לחם במאפייה זו כנראה קטנה מ $500$ ושהמאפייה פוגעת בציבור הצרכנים. אבל אם יתברר שבמדגם בגודל $30$ _״סביר מאוד״_ לקבל ממוצע כנ״ל או קטן ממנו (מתוף מ״מ עם תוחלת $500$ גרם וסטיית תקן של $3$ גרם), אזי אין לבוא בטענות אל המאפייה.

על מנת לבדוק את ההסתברות הנ״ל החוקרים נעזרים בעובדה שהמדגם בגודל 30 ומניחים ש 

$$\overline{X}\sim N\left(\mu, \frac{\sigma^{2}}{n}\right)$$

במקרה שלנו $\mu=500$ ו השונות היא $0.3$. כלומר $\overline{X}\sim N(500,0.3)$ . 
כעת אפשר לחשב את ההסתברות באמצעות נרמול. 

למרות שחישבנו את ההסתברות, החוקים עדיין לא יודעים מה זה אומר הסתברות ״קטנה״ או ״סבירה״ לכן צריך להחליט __לפני__ שמחשבים את ההסתברות , __כלל הכרעה__ ומחליטים לפיו. למשל, אם יוברר שההסתברות שיתקבל ממוצע של $498.5$ ומטה היא $5\%$ או פחות תחת התפלגות הדגימה הנ״ל, הרי ההשערה המצדיקה את המאפייה תידחה, וההשערה המצדיקה את הצרכנים תתקבל. 

__עוד לפני חישוב__ ההסתברות, ניתן לראות שהחוקרים קובעים לעצמם איזשהו כלל הכרעה ולמעשה קובעים את הגבול בין הסתברות ״ניכרת״ להסתברות ״זעומה״. בהתאם לכך, יכולים החוקרים לבדוק באיזו השערה לתמוך לפי כלל ההכרעה שקבענו. 

![Screenshot 2023-08-04 at 16.48.56.png|300](/img/user/Assets/Screenshot%202023-08-04%20at%2016.48.56.png)
זוהי התפלגות הדגימה הנורמלית שתיארנו למעלה.
אם ננרמל את ההתפלגות שלנו נקבל $Z\sim N(0,1)$ ,  אנו יודעים שבהתפלגות זו  הערך שמתחתיו נמצאים $5$ אחוז מן ההתפלגות הוא : $-1.645$ הוא: $P(Z\leq -1.645)=P(Z>1.645)= 1-\Phi(1.645)= 1-0.95=0.05$ .
לפיכך נוכל להציע את הכלל הבא:
אם ציון התקן של ממוצע המדגם קטן מ $-1.645$ נקבע שתלונת הצרכנים מוצדקת.

במילים אחרות: אם בגרף הנ״ל יימצא שערך המשתנה $Z$ המתאים לממוצע המדגם $498.5$ הוא משמאל לנקודה $-1.645$ אז נקבל את טענת הצרכנים אחרת נקבל את טענת המאפייה.
![Screenshot 2023-08-04 at 17.01.56.png|450](/img/user/Assets/Screenshot%202023-08-04%20at%2017.01.56.png)
לאזור משמאל קוראים __אזור דחייה__ ולתחום מימין קוראים __אזור קבלה__. אם נחשב נראה שציון התקן $z_{498.5}=-2.73<-1.645$  ולכן על החוקרים להסיק כי מאחר שההסתברות לקבל את הערך $498.5$ או ערך נמוך ממנו, ממשתנה מקרי שתוחלתו $500$ גרם (עם $\sigma=3$) היא קטנה, יש יסוד לחשד שתוחלת המשתנה המקרי אינה $500$ גרם אלא קטנה יותר, ויש לדחות את טענ המאפייה, כלומר לקבל את טענת הצרכנים.

באופן שקול, יכולים החוקרים לקבוע רווח סמך ל $\mu$ לפי ממוצע המדגם ברמה של $95\%$ . 

הנוסחה הכללי של רווח סמך היא 
$$\overline{X}- z_{1-\frac{\alpha}{2}} \frac{\sigma}{\sqrt{n}}<\mu<\overline{X}+ z_{1-\frac{\alpha}{2}} \frac{\sigma}{\sqrt{n}}$$
אם רמת הסמך היא $0.95$ אז $\alpha=0.05$ ו $\frac{\alpha}{2}=0.025$ כלומר $z_{1-\frac{\alpha}{2}}=1.96$  כלומר :

$$\Phi(1.96)=1- \frac{\alpha}{2}\to P(Z\leq 1.96)=0.975\to P(Z\geq 1.96)=0.025$$

אם כן, נוכל להציב בנוסחה הנ״ל את $z=1.96, \frac{\sigma}{\sqrt{n}}= \frac{3}{\sqrt{30}}=0.55, \overline{X}=498.5$ 
כאשר נציב נקבל 

$$497.42<\mu< 499.58$$ נזכיר שהמשמעות של רווח סמך היא שאם היינו מוציאים אינסוף מדגמים בגודל $30$ מאותה אוכלוסייה ועבור כל אחד מהם מחשבים ממוצע ורווח סמך, היינו מקבלין ש$95$ אחוז מהרווחים היו כוללים את הפרמטר ו $5\%$  לא היו כוללים אותו.
לפי הרווח סמך קיבלנו  שהתוחלת $500$ לא נמצאת בתחום ברווח הסמך שרצינו ולכן גם כאן יש תמיכה בצרכנים שהתוחלת איננה 500 גרם.

>[!note] הבחנה
>אם יש לנו השערה כלשהי $H_{0}$ נרצה לבדוק האם בהנחה שהיא נכונה ממוצע המדגם שלנו נמצא באזור הדחייה או לא. 
באופן מקוצר לדרך הנ״ל אפשר לחשב את אזור הדחייה נסמנו $C$ על ידי 
$$C=\mu + z_{1- \frac{\alpha}{2}} \frac{\sigma}{\sqrt{n}}$$            בעצם זה שקול לחישוב שעשינו למעלה שבוא קבענו מהו אזור הדחייה לפי רמת המובהקות ($\alpha$) רק שבמקום להתאים את המדגם להתפלגות נורמלית סטנדרטית מבצעים התאמה של אזור הדחייה להתפלגות של ממוצע המדגם $\overline{X}\sim N(\mu,\frac{\sigma^{2}}{n})$ .
לאחר מכן כל שצריך לעשות הוא האם ממוצע המדגם הספציפי שלנו נמצא בטווח המתאים לפי ההשערה $H_{1}$ .

### שלבים כלליים לבדיקת השערות
#### קביעת ההשערות
בכל בדיקת השערות מנוסחות שתי השערות אשר סותרות זו את זו.
__השערת האפס__ : $H_{0}$ - מתארת את ההנחות הקיימות בנקודת מוצא.
__השערה אלטרנטיבית__ : $H_{1}$ 
![Screenshot 2023-08-05 at 15.28.18.png|350](/img/user/Assets/Screenshot%202023-08-05%20at%2015.28.18.png)
הדוגמאות מדגימות מספר מצבים:
1. ההשערות יכולות להתייחס לפרמטרים שונים.
2. השעה יכולה להתייחס לפרמטר של אוכלוסייה אחת או להשוואה של פרמטר מסויים באוכלוסיות שונות.
3. בהשערות לגבי פרמטר של אוכלוסייה, או של משתנה מקרי, נהוג להבחין בין __השערה פשוטה-__ שבה ערכו של הפרמטר נקוב בה באופן חד משמעי.
  __השערה מורכבת-__ שבה מצויין טווח שבו נמצא הפרמטר.
4. ההשערות ייקראו __חד צדדיות__ אם $H_{1}$ מתייחס רק לערכים שנמצאים מצד אחד לערך הנקוב ב$H_{0}$ ו __דו צדדית__ כאשר $H_{1}$ מתייחס לערכים הנקובים משני הצדדים.

האפשריות הנ״ל משפיעות על קביעת אזור הדחייה שלנו.
1. בדוגמה הנ״ל אזור הדחייה היה רק בצד שמאל של ההתפלגות כיוון שההשערה האלטרנטיבית הייתה $\mu<500$ .
2. אם ההשערה האלטרנטיבית הייתה $H_{0}:\mu=500$ כלומר $H_{1}:\mu\neq 500$ כלומר השערה דו״צ אז אזור הדחייה היה מחולק לפי כלל ההכרעה לשני חלקים (במקרה של הדוגמה 5%) אזור המתאים ל 2.5% מימין ואזור מתאים ל 2.5% משמאל.

__לסיכום__
בקביעת ההשערות אנחנו בפועל מתייחסים ל3 אפשריות:
א. $H_0:\theta=c,H_{1}:\theta>c$ 
ב. $H_0:\theta=c,H_{1}:\theta<c$
ג. $H_0:\theta=c,H_{1}:\theta\neq c$

#### בחירת סטטיסטי 
לאחר שנוסחו ההשערות, יש לבחור בסטטיסטי שיהווה אומד מתאים לפרמטר שנבדק ושאותו נחשב מהמדגם. בדרך כלל נשתמש בסטטיסטי המהווים __אומד חסר הטייה.

#### קביעת ההנחות
קביעה של הגבול בין אזור הדחייה לאזור הקבלה. בשביל זה צריך לדעת את התפלגו הדגימה של המ״מ בו נשתמש, כדי להכריע בין $H_{0}$ ל $H_{1}$ .
הרבה פעמים התצפיות מפולגות בהתפלגות נורמלית או בינומית. אם אנחנו לא יודעים את ההתפלגות של תצפיות אז הבעיה נעשית סבוכה יותר. 

#### קביעת גודל המדגם
מ[[Computer Science/Probability/Statistics/Statistical inference basics#משפט הגבול המרכזי\|משפט הגבול המרכזי]] אנחנו יודעים של $n$ יש חשיבות גבוהה בקביעת התפלגות הדגימה. וגם תהיה לו חשיבות בחישוב הסתברות ההכרעה המוטעית.

#### חישוב התפלגות הדגימה
כל מה שהגדרנו למעלה, מאפשר את חישוב של התפלגות הדגימה כדי לבדוק מהי ההסתברות לקבלת ערך הסטטיסטי שנתקבל במדגם בהנחת נכונות $H_{0}$ .

#### קביעת רמת המובהקות
קביעת כלל ההכרעה, שבו יהיה תלוי גודל אזור הדחייה. אחוז זה מסומן ב$\alpha$ ונקרא __רמת המובהקות__ של מבחן. בעצם זהו גודל השטח של אזור הדחייה של $H_{0}$ בהתפלגות הדגימה, בהנחה ש $H_{0}$ נכונה. זה גם מסמן את ההסתברות שקיבלנו מדגם יוצא דופן אשר יטעה אותנו ונדחה את $H_{0}$ למרות שהיא נכונה.

#### קביעת אזורי דחייה וקבלה
אזורי דחייה וקבלה של ההשערה $H_{0}$. גודל האזור נקבע לפי רמת המובהקות, ומיקומו בהתפלגות הדגימה תלוי בסוג ההשערה: חד צדדית או דו צדדית.
