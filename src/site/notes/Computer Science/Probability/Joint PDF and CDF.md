---
{"dateCreated":"2023-01-11 19:27","tags":["probability","computer_science"],"pageDirection":"rtl","dg-publish":true,"permalink":"/computer-science/probability/joint-pdf-and-cdf/","dgPassFrontmatter":true}
---



# איחוד PDF ו CDF של מספר משתנים רנדומיים

## JOINT PDF 

בדומה ל [[Computer Science/Probability/Joint PMF\|Joint PMF]] נרצה להרחיב את המודל של [[Computer Science/Probability/Continuous Random Variables#PDF\|משתנים מקריים רציפים]] למספר משתנים רנדומיים. 

נאמר ששתי משתנים מקריים רציפים שמקושרים לאותו ניסוי הם __רציפים באופן מאוחד__. ניתן לתאר אותו כ joint PDF ומסומן גם $f_{XY}$ בהינתן שזאת פונקצייה אי שלילית שמקיימת לכל תת קבוצה של $B$ במישור הדו מימדי:
$$P((X,Y)\in B) = \int\limits_{(x,y)\in B}\int f_{XY}(x,y)dxdy$$


האנוטציה הזאת מגיעה מ [[Computer Science/Calculus/two variables functions#אינטגרלים כפולים (מסויים)\|אינטגרלים כפולים]] וזה אומר שהפונקצייה אינטגרבילית בקטע הזה. במקרה הספציפי שיש לנו מרובע מהצורה 
$$B=\{(x,y) \ | \ a\leq x\leq b, c\leq y \leq d \ \}$$
יתקיים :
$$P(a\leq X\leq b \cap c\leq Y\leq d) = \int_{c}^{d}\int_{a}^{b} f_{X,Y}(x,y)dxdy$$
אם נרצה ש$B$ יהיה כל המישור הדוד מימדי נקבל מתכונת הנורמלזיצייה
$$\int_{-\infty}^{\infty}\int_{-\infty}^{\infty} f_{X,Y}(x,y)dxdy=1$$
![Pasted image 20230111194920.png|200](/img/user/Assets/Pasted%20image%2020230111194920.png)
==כמו שבמקרה הרציף של משתנה בודד היינו אומרים שהסתברות היא שטח, פה הסתברות היא נפח. כלומר השטח במישור למטה הוא הקבוצה שאנחנו מחפשים והערכים שמקבלים , מה שלמעלה זה ערכי הפונקצייה והנפח זה ההסתברות==
כדי לקבל אינטואצייה על ה PDF המשותף, נגיד $\delta$ להיות מספר חיובי קטן מאוד ונסתכל על ההסתברות של מלבן קטן 
$$P(a\leq X\leq a + \delta , c\leq Y\leq c+\delta)=\int_{c}^{c+\delta}\int_{a}^{a+\delta} f_{X,Y}(x,y)dxdy\simeq f_{X,Y}(a,c)\cdot \delta^{2}$$
אם כן, נוכל להסתכל על  $f_{X,Y}(a,c)$ כ ״הסתברות ביחס ליחידת שטח״ בסביבה של $(a,c)$. 
הPDF המשותף מכיל את כל המידע ההסתברותי הרלוונטי על המשתנים המקריים $X,Y$ והתלויות שלהם.
זה מאפשר לנו לחשב את ההסתברות של כל מאורע שיכול להיות מוגדר במונחים של שתי המשתנים המקריים האלו. נוכל גם לחשב את הPDF השולי כלומר של כל אחד מהמשתנים הללו בנפרד על ידי:
$$P(X\in A) = P(X\in A \ \ and \ \ Y\in (-\infty,\infty))= \int_{A}\int_{-\infty}^{\infty} f_{X,Y}(x,y)dydx$$
השיוויון השני נובע מתכונת הנורמליזצייה שהמאורע $P(Y\in(-\infty ,\infty)) =1$ ולכן אין באמת חשיבות בחיתוך שתי המאורעות. אם כן, נוכל להשוות את הנ״ל עם 
$$P(X\in A) = \int_{A}f_{X}(x)dx$$
ונקבל שה PDF השולי  $f_{X}$ הינו 
$$\int_{A}f_{X}(x) = \int_{A}\int_{-\infty}^{\infty} f_{X,Y}(x,y)dy$$
כלומר הביטויים שבתוך האינטגרל שקולים (נובע מ [[Computer Science/Calculus/The Integral#המשפט היסודי\|המשפט היסודי]]) לכן:
$$f_{X}(x) = \int_{-\infty}^{\infty} f_{X,Y}(x,y)dy$$
באופן דומה נקבל 
$$f_{Y}(y)= \int_{-\infty}^{\infty} f_{X,Y}(x,y)dx$$

> [!question] מה הרעיון מאחורי ההוכחה הנ״ל?
> אנחנו מבצעים ״אינטגרצייה החוצה״ של ערכי $x$ או $y$ תלוי מה נרצה לקבל. זה כמו שבעולם הבדיד סכמנו את כל הזוגות $(x,y)$  שהתאימו לנו כדי לקבל הסתברות של אחד מהם. אז כאן מבצעים אינטגרצייה של כל ערכי $x$ האפשריים (מסתכלים עליהם כקבוע) עם הנעלם $y$ כלומר מסתכלים עליה כפונקצייה במישור הדו מימדי ומחשבים את השטח בהינתן ש $x$ קבוע. אפשר לדמיין את זה קצת כמו for loop ממינוס אינסוף עד אינסוף שאוסף את כל הקטעים שאנחנו מצליחים למצוא לאורך $x$ מסויים. 
> למשל: 
![Pasted image 20230112204451.png|200](/img/user/Assets/Pasted%20image%2020230112204451.png)
אם נרצה לחשב מהו $f_{X}$ עבור ערך $x$ כלשהו בין $1,2$  נרוץ על הקו שציירנו ואיפה שיש ״אפור״ אנחנו מתחילים לסכום את השטח לכן רק מלהביט בציור אנחנו יכולים להגיד שהצבירה של השטח לאורך הקו הנ״ל יהיה $\frac{3}{4}$ ולכן זה יהיה ערך $f_{X}(x)$ כאשר $x\in[1,2]$.



### PDF משותף אחיד 
רומאו ויוליה יוצאים לדייט בזמן כלשהו, כל אחד מהם יגיע למקום המפגש באיחור קל של בין $0$ ל $1$ שעות (תרגיל דומה הוצג ב [[Computer Science/Probability/Continuous Random Variables#משתנה רנדומי אחיד רציף\|התפלגות אחידה רציפה]]).
יהי $X,Y$ מהווים את האיחוד של רומאו ויוליה בהתאמה. בהנחה שכל זוג $(x,y)$ הוא שווה הסתברות לזוג אחר, מודל הסתברותי עם  pdf משותף ייראה ככה
$$f_{X,Y}(x,y)= \begin{cases} c& 0\leq x\leq 1 \ \ and \ \ 0\leq y\leq 1  \\ 0 & else\end{cases}$$
כאשר $c$ הוא קבוע כלשהו. נבדוק מה צריך להיות ערכו בהינתן שתכונת הנורמליזצייה תתקיים:
$$\int_{-\infty}^{\infty}\int_{-\infty}^{\infty} f_{X,Y}(x,y)dxdy = \int_{0}^{1}\int_{0}^{1}c\cdot dxdy = 1$$
זה יתקיים רק אם $c=1$ .
אם כן קיבלנו דוגמה לPDF אחיד משותף. 
באופן כללי, לכל תת קבוצה $S$ במישור הדו מימדי, הPDF המשותף האחיד על S יהיה
$$f_{XY}(x,y) =\begin{cases}  \frac{1}{\text{area(S)}} & (x,y)\in S \\ 0 & else\end{cases}$$
ולכל $A\subset S$ ההסתברות ש$(X,Y)$ נמצא ב $A$ תהיה 
$$P((X,Y)\in A) = \int\limits_{(x,y)\in A} \int f_{X,Y}(x,y)dxdy = \frac{1}{\text{area(S)}}\int\limits_{(x,y)\in A} \int dxdy = \frac{\text{area(A)}}{\text{area(S)}} $$
בעצם נוכל להסתכל על זה באופן כזה ש $S$ הוא השטח הנמצא במשטח הדו מימדי ועלינו למצוא קבוע ככה שהנפח במישור התלת מידי יהיה 1.  הסיבה שעלינו למצוא קבוע כזה היא שאנחנו יודעים שמתכונת הנורמליזצייה הנפח תמיד חייב להיות אחד וההתפלגות אחידה לכל אורך השטח הזה  לכן לא משנה איזה מקטע ניקח הגובה שנצטרך לחשב כדי לקבל 1 תמיד יהיה אותו דבר והוא יהיה  $\frac{1}{\text{area(S)}}$.
![Pasted image 20230112201428.png|200](/img/user/Assets/Pasted%20image%2020230112201428.png)
באופן דומה נוכל לדמיין את ההסתברות של $X,Y$ להיות בשטח מסויים $A$ באופן הויזואלי הבא
![Pasted image 20230112201746.png|200](/img/user/Assets/Pasted%20image%2020230112201746.png)
כלומר $\text{area}(A\cap S) / \text{area(S)}$ (זוהי הכללה למה שאמרנו למעלה עבור קבוצה שמוכלת ב$S$) .

__דוגמה נוספת__: 
נניח ואנחנו יודעים שה PDF המשותף של שתי משתנים מקריים $X,Y$ הוא קבוע $c$ כאשר הערכים הם על הקבוצה $S$ במישור הדו מימדי שנראה כך
![Pasted image 20230112200115.png|250](/img/user/Assets/Pasted%20image%2020230112200115.png)
אחרת הפונקצייה מחזירה $0$. כלומר לפי ההתפלגות האחידה שדיברנו עלי $f_{X,Y}(x,y)=c = \frac{1}{4}$ לכל $(x,y)\in S$ .
במרחב התלת מידי אנחנו בעצם מגביהים את הצורה שיצרנו באופן כזה שהנפח יהיה $1$.
![Pasted image 20230112202141.png|200](/img/user/Assets/Pasted%20image%2020230112202141.png)
כעת אם נרצה לחשב את ה PDF השולי של $X,Y$ למשל $f_{X}(x)$ עבור $x$ כלשהו ננסה לחשב לפי הנוסחה על האינטגרל של הPDF המשותך ממינוס אינסוף עד אינסוף ביחס ל dy. 
אם כן כאשר $y$ שואף לאינסוף ומינוס אינסוף נוכל לחלק את השטח $S$ לשתיים ונקבל 
![Pasted image 20230112204451.png|200](/img/user/Assets/Pasted%20image%2020230112204451.png)
כלומר כאשר $x$ הוא בתחום שבין 1,2 השטח יהיה $3$ כלומר הוא מהווה $\frac{3}{4}$ מהשטח של $S$ .
כאשר $x$ הוא בתחום שבין 2,3 נקבל תרומהשל $1$ לשטח של $S$ כלומר השטח היה $\frac{1}{4}$ . 
בכל שאר המקרים השטח הוא $0$. אם כן זה ייראה כך :
![Pasted image 20230112204826.png|200](/img/user/Assets/Pasted%20image%2020230112204826.png)
באופן דומה אם נבחן מה קורה עבור ה PDF השולי של $y$ , נשאיף את $x$ לאינסוף ומינוס אינסוף ונקבל שהאינטגרל של הPDF המשותף בטווח לפי dx ימודל כך
![Pasted image 20230112204953.png|200](/img/user/Assets/Pasted%20image%2020230112204953.png)
כלומר כאשר $y$ הוא בתחום שבין $1$ ל $2$ נקבל תרומה של $1$ לשטח כלומר השטח הוא $\frac{1}{4}$ כאשר אנחנו בין $2-3$ נקבל $\frac{2}{4}$ ובין 3 ל 4 שוב $\frac{1}{4}$ 
סך הכל זה ייראה ככה
![Pasted image 20230112205156.png|200](/img/user/Assets/Pasted%20image%2020230112205156.png)

__נשים לב למשהו לא אינטואיטיבי שככל שהשטח שאנחנו עובדים איתו קטן יותר בהתפלגות אחידה, ככה נקבל שהערך שפונקציית הצפיפות תחזיר גדולה יותר! הסיבה נובעת מתכונת הנורמליזצייה שדורשת שהנפח יהיה 1 כלומר על מנת שזה יתקיים ככל שהשטח קטן יותר ערך הפונקצייה המוחזר חייב להיות גדול יותר__ . זה מאוד דומה גם לנוסחה של התפלגות אחידה רציפה עם משתנה אחד $\frac{1}{b-a}$ ככל שהקטע קטן יותר ככה ההסתברות שהפונקצייה תחזיר גדולה יותר.


## Buffon's Needle 

זאת דוגמה מפורסמת , שמדגימה גם את המקור של הסוגייה הקשורה בהסתברות גיאומטרית. כלומר, הניתוח של קונפיגורצייה גיאומטרית של אובייקטים שממוקמים באופן רנדומי במרחב.
על משטח מסומנים ישרים מקבילים במרחק $d$ אחד מהשני. נניח שאנחנו זורקים מחט באורך $l$ על המשטח במיקום אקראי, מה הסיבוי שהמחט תיחתך עם אחד הקווים?
![Pasted image 20230118003657.png|300](/img/user/Assets/Pasted%20image%2020230118003657.png)
נניח גם ש $l<d$ כדי שהמחט לא תחתוך את שתי הישרים ביחד. נגיד את $X$ להיות המרחק האנכי מאמצע המחט לקו הכי קרוב. נגדיר את $\Theta$ להיות הזווית החדה הנוצרת בין המחט לקו המקביל.
נמדל את זוג המשתנים המקריים $(X,\Theta)$ עם PDF משותף המוגדר על הקבוצה המלבנית:

$$\{ \ (x,\theta) \ \ |  \ \  0\leq x\leq \frac{d}{2} \ , \ 0\leq\theta\leq \frac{\pi}{2}\ \}$$
כמו כן נשים לב שמדובר בהתפלגות אחידה שכן בחירה של $x$ ו $\theta$ נבחרים בהתפלגות אחידה בתוך התחומים שלהם. 
סך הכל מהגדרה של התפלגות אחידה נקבל 

$$f_{X,\Theta}(x,\theta)= \begin{cases} \frac{4}{d\pi} &  0\leq x\leq \frac{d}{2} \ , \ 0\leq\theta\leq \frac{\pi}{2} \\  \\
0&else \end{cases}$$

נשים לב מהשרטוט למעלה שהמחט תיחתך עם אחד הקווים אם ורק אם 

$$X\leq \frac{1}{2}l\cdot\sin\Theta$$
![Pasted image 20230118012334.png|300](/img/user/Assets/Pasted%20image%2020230118012334.png)

אם כן נחשב 

$$\displaylines{
P\left(X\leq \frac{l}{2}\sin\Theta\right)= \int\limits_{x\leq \frac{l}{2}\sin\theta}\int f_{X,\Theta}(x,\theta)dxd\theta \\= \frac{4}{d\pi}\int_{0}^{\frac{\pi}{2}}\int_{0}^{\frac{l}{2}\sin\theta}dxd\theta \\= \frac{4}{\pi\cdot d} \int_{0}^{\frac{\pi}{2}} \frac{l}{2}\sin\theta d\theta \\= \frac{2l}{d\pi}(-\cos\theta)\bigg|_{0}^{\frac{\pi}{2}} = \frac{2l}{d\pi}
}$$

נשים לב שע"פ החישוב מתקיים:

$$P= \frac{2l}{d\pi}\rightarrow \pi = \frac{2l}{d}$$
מכאן מתקבל [קירוב אמפירי](https://he.wikipedia.org/wiki/%D7%A0%D7%95%D7%A1%D7%97%D7%94_%D7%90%D7%9E%D7%A4%D7%99%D7%A8%D7%99%D7%AA_(%D7%A4%D7%99%D7%96%D7%99%D7%A7%D7%94)) ל $\pi$ .

## CDF משותף
אם $X,Y$ הם שתי משתנים מקריים שמשוייכים לאותו ניסוי, נגדיר את ה [[Computer Science/Probability/CDF\|CDF]] המשותף שלהם כך

$$F_{X,Y}(x,y)= P(X\leq x, Y\leq y)= \int_{-\infty}^{x}\int_{-\infty}^{y}f_{X,Y}(s,t)dtds$$
אם כן מהמשפט היסודי של האינטגרל אנחנו יכולים להסיק ש 
$$f_{X,Y}(x,y)= \frac{\partial^{2}F_{X,Y}}{\partial x\partial y}(x,y)$$
כאשר $\partial$ זה מסמן נגזרת חלקי והחזקה ריבועית סך הכל אומר שמבצעים נגזרת חלקית פעמיים, פעם אחת לפי $x$ ולאחר מכן לפי $y$ .

לדוגמה: אם יתקיים ש $\forall_{0\leq x,y\leq 1}:F_{X,Y}(x,y)=xy$ אזי
$$f_{X,Y}(x,y)= \frac{\partial^{2}F_{X,Y}}{\partial x\partial y}=\frac{\partial^{2}(xy)}{\partial x\partial y} = \frac{\partial}{\partial y}y = 1 $$
![Pasted image 20230123143853.png|300](/img/user/Assets/Pasted%20image%2020230123143853.png)

## תוחלת משותפת
אם $X,Y$ הם משתנים מקריים רציפים מאוחדים ו $g$ היא פונקצייה כלשהי על משתנים אלו. 
יתקיים ש $Z=g(X,Y)$ היא גם משתנה מקרי. 
התוחלת של $Z$ תהיה
$$E[g(X,Y)]=\int\limits_{-\infty}^{\infty}\int\limits_{-\infty}^{\infty} g(x,y)f_{X,Y}(x,y)dxdy$$

וזה כמובן מוביל למקרה הפרטי של הפונקצייה הליניארית:

$$E[g(X,Y)]= E[aX+bY+c]= aE[X]+bE[Y]+c$$

## הכללה למספר משתנים מקריים
ה PDF המשותף של שלושה משתנים מקריים $X,Y,Z$ מוגדר באופן דומה למקרה של שתי משתנים מקריים רציפים:

$$P((X,Y,Z)\in B)= \underset{(x,y,z)\in B}{\int\int\int}f_{X,Y,Z}(x,y,z)dxdydz$$
באופן דומה למקרה של שתי משנים נוכל לחלץ את הפונקציות השוליות

$$\displaylines{
f_{X,Y}(x,y)
=\int\limits_{-\infty}^{\infty}f_{X,Y,Z}(x,y,z)dz \\
\\
f_{X}(x)=\int\limits_{-\infty}^{\infty}\int\limits_{-\infty}^{\infty} f_{X,Y,Z}(x,y,z)dydz
}$$

התוחלת תקיים:

$$E[g(X,Y,Z)]=\int\limits_{-\infty}^{\infty}\int\limits_{-\infty}^{\infty}\int\limits_{-\infty}^{\infty} g(x,y,z)f_{X,Y,Z}(x,y,z)dxdydz$$

והמקרה הפרטי הליניארי:

$$E[g(X,Y,Z)]=E[aX+bY+cZ]=aE[X]+bE[Y]+cE[x]$$

כמובן שנוכל להכליל את הנוסחה של התוחלת הנ״ל באופן ברור עבור $X_{1},X_{2},\dots,X_{n}$ משתנים מקריים רציפים:

$$E\left[\sum\limits_{i=1}^{n} a_{i}X_{i}\right]=\sum\limits_{i=1}^{n}a_{i}E[X_{i}]$$
