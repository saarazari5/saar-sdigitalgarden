---
dateCreated: "2023-01-11 19:27"
tags: [probability, computer_science]
dg-publish: true
dg-home: false
---


# איחוד PDF ו CDF של מספר משתנים רנדומיים

## JOINT PDF 

בדומה ל [[איחוד PMF של מספר משתנים רנדומיים]] נרצה להרחיב את המודל של [[משתנים רנדומיים - רציף#PDF]] למספר משתנים רנדומיים. 

נאמר ששתי משתנים מקריים רציפים שמקושרים לאותו ניסוי הם __רציפים באופן מאוחד__. ניתן לתאר אותו כ joint PDF ומסומן גם $f_{XY}$ בהינתן שזאת פונקצייה אי שלילית שמקיימת לכל תת קבוצה של $B$ במישור הדו מימדי:
$$P((X,Y)\in B) = \int\limits_{(x,y)\in B}\int f_{XY}(x,y)dxdy$$


האנוטציה הזאת מגיעה מ [[פונקציות עם שני משתנים#אינטגרלים כפולים (מסויים)]] וזה אומר שהפונקצייה אינטגרבילית בקטע הזה. במקרה הספציפי שיש לנו מרובע מהצורה 
$$B=\{(x,y) \ | \ a\leq x\leq b, c\leq y \leq d \ \}$$
יתקיים :
$$P(a\leq X\leq b \cap c\leq Y\leq d) = \int_{c}^{d}\int_{a}^{b} f_{X,Y}(x,y)dxdy$$
אם נרצה ש$B$ יהיה כל המישור הדוד מימדי נקבל מתכונת הנורמלזיצייה
$$\int_{-\infty}^{\infty}\int_{-\infty}^{\infty} f_{X,Y}(x,y)dxdy=1$$
![[Pasted image 20230111194920.png|200]]
==כמו שבמקרה הרציף של משתנה בודד היינו אומרים שהסתברות היא שטח, פה הסתברות היא נפח.==
כדי לקבל אינטואצייה על ה PDF המשותף, נגיד $\delta$ להיות מספםר חיובי קטן מאוד ונסתכל על ההסתברות של מלבן קטן 
$$P(a\leq X\leq a + \delta , c\leq Y\leq c+\delta)=\int_{c}^{c+\delta}\int_{a}^{a+\delta} f_{X,Y}(x,y)dxdy\simeq f_{X,Y}(a,c)\cdot \delta^{2}$$
אם כן, נוכל להסתכל על  $f_{X,Y}(a,c)$ כ ״הסתברות ביחס ליחידת שטח״ בסביבה של $(a,c)$. 
הPDF המשותף מכיל את כל המידע ההסתברותי הרלוונטי על המשתנים המקריים $X,Y$ והתלויות שלהם.
זה מאפשר לנו לחשב את ההסתברות של כל מאורע שיכול להיות מוגדר במונחים של שתי המשתנים המקריים האלו. נוכל גם לחשב את הPDF השולי כלומר של כל אחד מהמשתנים הללו בנפרד על ידי:
$$P(X\in A) = P(X\in A \ \ and \ \ Y\in (-\infty,\infty))= \int_{A}\int_{-\infty}^{\infty} f_{X,Y}(x,y)dydx$$
השיוויון השני נובע מתכונת הנורמליזצייה שהמאורע $P(Y\in(-\infty ,\infty)) =1$ ולכן אין באמת חשיבות בחיתוך שתי המאורעות. אם כן, נוכל להשוות את הנ״ל עם 
$$P(X\in A) = \int_{A}f_{X}(x)dx$$
ונקבל שה PDF השולי  $f_{X}$ הינו 
$$\int_{A}f_{X}(x) = \int_{A}\int_{-\infty}^{\infty} f_{X,Y}(x,y)dy$$
כלומר הביטויים שבתוך האינטגרל שקולים (נובע מ [[האינטגרל#המשפט היסודי]]) לכן:
$$f_{X}(x) = \int_{-\infty}^{\infty} f_{X,Y}(x,y)dy$$
באופן דומה נקבל 
$$f_{Y}(y)= \int_{-\infty}^{\infty} f_{X,Y}(x,y)dx$$
הרעיון הוא שניצלנו את תכונת 

### PDF משותף אחיד 
רומאו ויוליה יוצאים לדייט בזמן כלשהו, כל אחד מהם יגיע למקום המפגש באיחור קל של בין $0$ ל $1$ שעות (תרגיל דומה הוצג ב [[משתנים רנדומיים - רציף#משתנה רנדומי אחיד רציף]]).
יהי $X,Y$ מהווים את האיחוד של רומאו ויוליה בהתאמה. בהנחה שכל זוג $(x,y)$ הוא שווה הסתברות לזוג אחר, מודל הסתברותי עם  pdf משותף ייראה ככה
$$f_{X,Y}(x,y)= \begin{cases} c& 0\leq x\leq 1 \ \ and \ \ 0\leq y\leq 1  \\ 0 & else\end{cases}$$
כאשר $c$ הוא קבוע כלשהו. נבדוק מה צריך להיות ערכו בהינתן שתכונת הנורמליזצייה תתקיים:
$$\int_{-\infty}^{\infty}\int_{-\infty}^{\infty} f_{X,Y}(x,y)dxdy = \int_{0}^{1}\int_{0}^{1}c\cdot dxdy = 1$$
זה יתקיים רק אם $c=1$ .
אם כן קיבלנו דוגמה לPDF אחיד משותף. 
באופן כללי, לכל תת קבוצה $S$ במישור הדו מימדי, הPDF המשותף האחיד על S יהיה
$$f_{XY}(x,y) =\begin{cases}  \frac{1}{\text{area(S)}} & (x,y)\in S \\ 0 & else\end{cases}$$
ולכל $A\subset S$ ההסתברות ש$(X,Y)$ נמצא ב $A$ תהיה 
$$P((X,Y)\in A) = \int\limits_{(x,y)\in A} \int f_{X,Y}(x,y)dxdy = \frac{1}{\text{area(S)}}\int\limits_{(x,y)\in A} \int dxdy = \frac{\text{area(A)}}{\text{area(S)}} $$
בעצם נוכל להסתכל על זה באופן כזה ש $S$ הוא השטח הנמצא במשטח הדו מימדי ועלינו למצוא קבוע ככה שהנפח במישור התלת מידי יהיה 1.  הסיבה שעלינו למצוא קבוע כזה היא שאנחנו יודעים שמתכונת הנורמליזצייה הנפח תמיד חייב להיות אחד וההתפלגות אחידה לכל אורך השטח הזה  לכן לא משנה איזה מקטע ניקח הגובה שנצטרך לחשב כדי לקבל 1 תמיד יהיה אותו דבר והוא יהיה  $\frac{1}{\text{area(S)}}$.
![[Pasted image 20230112201428.png|200]]
באופן דומה נוכל לדמיין את ההסתברות של $X,Y$ להיות בשטח מסויים $A$ באופן הויזואלי הבא
![[Pasted image 20230112201746.png|200]]
כלומר $\text{area}(A\cap S) / \text{area(S)}$ (זוהי הכללה למה שאמרנו למעלה עבור קבוצה שמוכלת ב$S$) .

__דוגמה נוספת__: 
נניח ואנחנו יודעים שה PDF המשותף של שתי משתנים מקריים $X,Y$ הוא קבוע $c$ כאשר הערכים הם על הקבוצה $S$ במישור הדו מימדי שנראה כך
![[Pasted image 20230112200115.png|250]]
אחרת הפונקצייה מחזירה $0$. כלומר לפי ההתפלגות האחידה שדיברנו עלי $f_{X,Y}(x,y)=c = \frac{1}{4}$ לכל $(x,y)\in S$ .
במרחב התלת מידי אנחנו בעצם מגביהים את הצורה שיצרנו באופן כזה שהנפח יהיה $1$.
![[Pasted image 20230112202141.png|200]]
כעת אם נרצה לחשב את ה PDF השולי של $X,Y$ למשל $f_{X}(x)$ עבור $x$ כלשהו ננסה לחשב לפי הנוסחה על האינטגרל של הPDF המשותך ממינוס אינסוף עד אינסוף ביחס ל dy. 
אם כן כאשר $y$ שואף לאינסוף ומינוס אינסוף נוכל לחלק את השטח $S$ לשתיים ונקבל 
![[Pasted image 20230112204451.png|200]]
כלומר כאשר $x$ הוא בתחום שבין 1,2 השטח יהיה $3$ כלומר הוא מהווה $\frac{3}{4}$ מהשטח של $S$ .
כאשר $x$ הוא בתחום שבין 2,3 נקבל תרומהשל $1$ לשטח של $S$ כלומר השטח היה $\frac{1}{4}$ . 
בכל שאר המקרים השטח הוא $0$. אם כן זה ייראה כך :
![[Pasted image 20230112204826.png|200]]
באופן דומה אם נבחן מה קורה עבור ה PDF השולי של $y$ , נשאיף את $x$ לאינסוף ומינוס אינסוף ונקבל שהאינטגרל של הPDF המשותף בטווח לפי dx ימודל כך
![[Pasted image 20230112204953.png|200]]
כלומר כאשר $y$ הוא בתחום שבין $1$ ל $2$ נקבל תרומה של $1$ לשטח כלומר השטח הוא $\frac{1}{4}$ כאשר אנחנו בין $2-3$ נקבל $\frac{2}{4}$ ובין 3 ל 4 שוב $\frac{1}{4}$ 
סך הכל זה ייראה ככה
![[Pasted image 20230112205156.png|200]]

__נשים לב למשהו לא אינטואיטיבי שככל שהשטח שאנחנו עובדים איתו קטן יותר בהתפלגות אחידה, ככה נקבל שההסתברות שפונקציית הצפיפות תחזיר גדולה יותר! הסיבה נובעת מתכונת הנורמליזצייה שדורשת שהנפח יהיה 1 כלומר על מנת שזה יתקיים ככל שהשטח קטן יותר ערך הפונקצייה המוחזר חייב להיות גדול יותר__ . זה מאוד דומה גם לנוסחה של התפלגות אחידה רציפה עם משתנה אחד $\frac{1}{b-a}$ ככל שהקטע קטן יותר ככה ההסתברות שהפונקצייה תחזיר גדולה יותר.


## Buffon's Needle 

